{% extends "base.html" %}

{%block title %}
<title>OP-Z Sample Manager</title>
{%endblock%}

{% block main %}
<h1>Welcome to OP-Z Sample Manager</h1>

<button onclick="fetchOpzSamples()" id="list-files">List Files</button>
<div id="sample-output"></div>

<button id="confirm-changes">Confirm Changes</button>

<div id="file-list">
    <h3>Kicks</h3>
    <div class="samplepackbox" id="1-kick"></div>
    <h3>Snares</h3>
    <div class="samplepackbox" id="2-snare"></div>
    <h3>Percussion</h3>
    <div class="samplepackbox" id="3-perc"></div>
    <h3>FX</h3>
    <div class="samplepackbox" id="4-fx"></div>
    <h3>Bass</h3>
    <div class="samplepackbox" id="5-bass"></div>
    <h3>Lead</h3>
    <div class="samplepackbox" id="6-lead"></div>
    <h3>Arpeggio</h3>
    <div class="samplepackbox" id="7-arpeggio"></div>
    <h3>Chords</h3>
    <div class="samplepackbox" id="8-chord"></div>
</div>

<script>
    async function fetchOpzSamples() {
        try {
            const response = await fetch("http://localhost:5000/read-samples");
            if (!response.ok) {
                throw new Error("Network response was not ok: " + response.statusText);
            }
            const data = await response.json();
    
            console.log("Sample Categories:", data.categories);
            console.log("First kick slot path:", data.sampleData[0][0].path);
    
            // Example: update your HTML here
            const container = document.getElementById("sample-output");
            container.innerHTML = data.categories.map((cat, i) => {
                return `<div><strong>${cat}</strong>: ${data.sampleData[i].map(slot => slot.path || "(empty)").join(", ")}</div>`;
            }).join("<br>");
            
        } catch (error) {
            console.error("Failed to fetch OP-Z samples:", error);
        }
    }
    </script>


{% endblock %}

</html>